(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e61960a"],{2423:function(t,e,o){"use strict";o.d(e,"a",(function(){return s})),o.d(e,"e",(function(){return n})),o.d(e,"d",(function(){return r})),o.d(e,"b",(function(){return a})),o.d(e,"c",(function(){return l})),o.d(e,"f",(function(){return c}));var i=o("b775");function s(t){return Object(i["a"])({url:"/api/article/addArticle",method:"post",data:t})}function n(t){return Object(i["a"])({url:"/api/article/getArticleById",method:"get",params:{id:t}})}function r(t){return Object(i["a"])({url:"/api/article/editArticle",method:"put",data:t})}function a(t){return Object(i["a"])({url:"/api/article/delArticle",method:"delete",params:{id:t}})}function l(t){return Object(i["a"])({url:"/api/article/delArticle/"+t,method:"delete"})}function c(t){return Object(i["a"])({url:"/api/article/getArticles",method:"get",params:t})}},"4c7a":function(t,e){t.exports={apiUrl:{dev:"http://47.104.29.22:8088",pro:""},INDEX_PAGE:"index",proxyTable:{"/api":{target:"http://127.0.0.1:8080",timeout:36e5,changeOrigin:!0}}}},"704a":function(t,e){t.exports={bucketPubR:{bucketName:"yk-isystem",storageType:"Standard",dataRedundancyType:"Local",cannedACL:"PubR"}}},c2ce:function(t,e,o){"use strict";var i=o("ea22"),s=o.n(i);s.a},e821:function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"createPost-container"},[o("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:t.postForm,rules:t.rules}},[o("sticky",{attrs:{"z-index":10,"class-name":"sub-navbar "+t.postForm.status}},[o("CommentDropdown",{model:{value:t.postForm.comment,callback:function(e){t.$set(t.postForm,"comment",e)},expression:"postForm.comment"}}),t._v(" "),o("PlatformDropdown",{model:{value:t.postForm.articleClassIds,callback:function(e){t.$set(t.postForm,"articleClassIds",e)},expression:"postForm.articleClassIds"}}),t._v(" "),o("SourceUrlDropdown",{model:{value:t.postForm.source_uri,callback:function(e){t.$set(t.postForm,"source_uri",e)},expression:"postForm.source_uri"}}),t._v(" "),o("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:t.submitForm}},[t._v("\n        Publish\n      ")]),t._v(" "),o("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{type:"warning"},on:{click:t.draftForm}},[t._v("\n        Draft\n      ")])],1),t._v(" "),o("div",{staticClass:"createPost-main-container"},[o("el-row",[o("el-col",{attrs:{span:24}},[o("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{prop:"title"}},[o("MDinput",{attrs:{maxlength:100,name:"name",required:""},model:{value:t.postForm.title,callback:function(e){t.$set(t.postForm,"title",e)},expression:"postForm.title"}},[t._v("\n              标题\n            ")])],1),t._v(" "),o("div",{staticClass:"postInfo-container"},[o("el-row",[o("el-col",{attrs:{span:10}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"120px",label:t.$t("table.publishTime")}},[o("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"Select date and time"},model:{value:t.postForm.publishTime,callback:function(e){t.$set(t.postForm,"publishTime",e)},expression:"postForm.publishTime"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"90px",label:t.$t("table.importance")}},[o("el-rate",{staticStyle:{display:"inline-block"},attrs:{max:3,colors:["#99A9BF","#F7BA2A","#FF9900"],"low-threshold":1,"high-threshold":3},model:{value:t.postForm.importance,callback:function(e){t.$set(t.postForm,"importance",e)},expression:"postForm.importance"}})],1)],1)],1)],1)],1)],1),t._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{"label-width":"70px",label:"Summary:"}},[o("el-input",{staticClass:"article-textarea",attrs:{rows:1,type:"textarea",autosize:"",placeholder:"Please enter the content"},model:{value:t.postForm.articleSummary,callback:function(e){t.$set(t.postForm,"articleSummary",e)},expression:"postForm.articleSummary"}}),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:t.contentShortLength,expression:"contentShortLength"}],staticClass:"word-counter"},[t._v(t._s(t.contentShortLength)+"words")])],1),t._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"30px"},attrs:{prop:"content"}},[o("Tinymce",{ref:"editor",attrs:{height:400},model:{value:t.postForm.content,callback:function(e){t.$set(t.postForm,"content",e)},expression:"postForm.content"}})],1),t._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"30px"},attrs:{prop:"articleCover"}},[o("Upload",{attrs:{"article-cover-url":t.postForm.articleCoverUrl},model:{value:t.postForm.articleCover,callback:function(e){t.$set(t.postForm,"articleCover",e)},expression:"postForm.articleCover"}})],1)],1)],1)],1)},s=[],n=o("8256"),r=o("70a2"),a=o("1aba"),l=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{style:{height:t.height+"px",zIndex:t.zIndex}},[o("div",{class:t.className,style:{top:t.isSticky?t.stickyTop+"px":"",zIndex:t.zIndex,position:t.position,width:t.width,height:t.height+"px"}},[t._t("default",[o("div",[t._v("sticky")])])],2)])},c=[],u=(o("c5f6"),{name:"Sticky",props:{stickyTop:{type:Number,default:0},zIndex:{type:Number,default:1},className:{type:String,default:""}},data:function(){return{active:!1,position:"",width:void 0,height:void 0,isSticky:!1}},mounted:function(){this.height=this.$el.getBoundingClientRect().height,window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleResize)},activated:function(){this.handleScroll()},destroyed:function(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize)},methods:{sticky:function(){this.active||(this.position="fixed",this.active=!0,this.width=this.width+"px",this.isSticky=!0)},handleReset:function(){this.active&&this.reset()},reset:function(){this.position="",this.width="auto",this.active=!1,this.isSticky=!1},handleScroll:function(){var t=this.$el.getBoundingClientRect().width;this.width=t||"auto";var e=this.$el.getBoundingClientRect().top;e<this.stickyTop?this.sticky():this.handleReset()},handleResize:function(){this.isSticky&&(this.width=this.$el.getBoundingClientRect().width+"px")}}}),d=u,p=o("2877"),m=Object(p["a"])(d,l,c,!1,null,null,null),h=m.exports,f=o("61f7"),g=o("2423"),v=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dropdown",{attrs:{"show-timeout":100,trigger:"click"}},[o("el-button",{attrs:{plain:""}},[t._v("\n    "+t._s(1===t.comment_disabled?"评论: 开启":"评论: 关闭")+"\n    "),o("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),t._v(" "),o("el-dropdown-menu",{staticClass:"no-padding",attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",[o("el-radio-group",{staticStyle:{padding:"10px"},model:{value:t.comment_disabled,callback:function(e){t.comment_disabled=e},expression:"comment_disabled"}},[o("el-radio",{attrs:{label:0}},[t._v("\n          关闭\n        ")]),t._v(" "),o("el-radio",{attrs:{label:1}},[t._v("\n          开启\n        ")])],1)],1)],1)],1)},b=[],y={props:{value:{type:Number,default:!1}},computed:{comment_disabled:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}},w=y,F=Object(p["a"])(w,v,b,!1,null,null,null),_=F.exports,x=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dropdown",{attrs:{"hide-on-click":!1,"show-timeout":100,trigger:"click"}},[o("el-button",{attrs:{plain:""}},[t._v("\n    分类("+t._s(t.length)+")\n    "),o("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),t._v(" "),o("el-dropdown-menu",{staticClass:"no-border",attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-checkbox-group",{staticStyle:{padding:"5px 15px"},attrs:{size:"mini"},model:{value:t.platforms,callback:function(e){t.platforms=e},expression:"platforms"}},t._l(t.platformsOptions,(function(e){return o("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v("\n        "+t._s(e.name)+"\n      ")])})),1)],1)],1)},C=[],k=o("f7ef"),S={props:{value:{required:!0,default:function(){return[]},type:Array}},data:function(){return{platformsOptions:null,length:0}},computed:{platforms:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},created:function(){this.getList()},methods:{getList:function(){var t=this;Object(k["f"])(null).then((function(e){console.log(e),t.platformsOptions=e.data,t.length=e.data.length}))}}},$=S,O=Object(p["a"])($,x,C,!1,null,null,null),j=O.exports,A=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dropdown",{attrs:{"show-timeout":100,trigger:"click"}},[o("el-button",{attrs:{plain:""}},[t._v("\n    Link\n    "),o("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),t._v(" "),o("el-dropdown-menu",{staticClass:"no-padding no-border",staticStyle:{width:"400px"},attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{"label-width":"0px",prop:"source_uri"}},[o("el-input",{attrs:{placeholder:"Please enter the content"},model:{value:t.source_uri,callback:function(e){t.source_uri=e},expression:"source_uri"}},[o("template",{slot:"prepend"},[t._v("\n          URL\n        ")])],2)],1)],1)],1)},I=[],T={props:{value:{type:String,default:""}},computed:{source_uri:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}},E=T,R=Object(p["a"])(E,A,I,!1,null,null,null),L=R.exports,z=o("ed08"),P={status:2,title:"",content:"",articleSummary:"",source_uri:"",articleCover:"",articleCoverUrl:"",id:void 0,articleClassIds:[],articleClassId:"",comment:1,importance:0,publishTime:""},D={name:"ArticleDetail",components:{Tinymce:n["a"],MDinput:a["a"],Upload:r["a"],Sticky:h,CommentDropdown:_,PlatformDropdown:j,SourceUrlDropdown:L},props:{isEdit:{type:Boolean,default:!1}},data:function(){var t=this,e=function(e,o,i){""===o?(t.$message({message:e.field+"为必传项",type:"error"}),i(new Error(e.field+"为必传项"))):i()},o=function(e,o,i){o?Object(f["d"])(o)?i():(t.$message({message:"外链url填写不正确",type:"error"}),i(new Error("外链url填写不正确"))):i()};return{postForm:Object.assign({},P),loading:!1,userListOptions:[],rules:{title:[{validator:e}],content:[{validator:e}],source_uri:[{validator:o,trigger:"blur"}]},tempRoute:{}}},computed:{contentShortLength:function(){return this.postForm.articleSummary.length},lang:function(){return this.$store.getters.language}},created:function(){if(this.isEdit){var t=this.$route.params&&this.$route.params.id;this.getArticleById(t)}this.tempRoute=Object.assign({},this.$route)},methods:{getArticleById:function(t){var e=this;Object(g["e"])(t).then((function(t){e.postForm=t.data,console.log(t.data),t.data.articleClassId&&(e.postForm.articleClassIds=t.data.articleClassId.splice(",")),e.setTagsViewTitle(),e.setPageTitle()})).catch((function(t){console.log(t)}))},setTagsViewTitle:function(){var t="zh"===this.lang?"编辑文章":"Edit Article",e=Object.assign({},this.tempRoute,{title:"".concat(t,"-").concat(this.postForm.id)});this.$store.dispatch("tagsView/updateVisitedView",e)},setPageTitle:function(){var t="Edit Article";document.title="".concat(t," - ").concat(this.postForm.id)},submitForm:function(){console.log(this.postForm),this.saveArticle(1)},saveArticle:function(t){var e=this;this.$refs.postForm.validate((function(o){if(!o)return console.log("error submit!!"),!1;e.loading=!0,e.postForm.status=t,e.postForm.comment?e.postForm.comment=1:e.postForm.comment=0,e.postForm.publishTime=Object(z["c"])(e.postForm.publishTime,"yyyy-MM-dd hh:mm:ss"),e.postForm.articleClassIds.length>0&&(e.postForm.articleClassId=e.postForm.articleClassIds.join(",")),console.log(e.postForm),e.postForm.id?Object(g["d"])(e.postForm).then((function(o){e.checkStatus(t,o)})):Object(g["a"])(e.postForm).then((function(o){e.checkStatus(t,o),e.postForm=Object.assign({},P)}))}))},checkStatus:function(t,e){1===t?this.$notify({title:"成功",message:e.message,type:"success",duration:2e3}):this.$message({message:"保存草稿成功",type:"success",showClose:!0,duration:1e3}),this.loading=!1},draftForm:function(){this.saveArticle(2)}}},B=D,N=(o("c2ce"),Object(p["a"])(B,i,s,!1,null,"6c4f8af1",null));e["a"]=N.exports},ea22:function(t,e,o){},f7ef:function(t,e,o){"use strict";o.d(e,"a",(function(){return s})),o.d(e,"d",(function(){return n})),o.d(e,"b",(function(){return r})),o.d(e,"c",(function(){return a})),o.d(e,"f",(function(){return l})),o.d(e,"e",(function(){return c}));var i=o("b775");function s(t){return Object(i["a"])({url:"/api/articleClass/addArticleClass",method:"post",data:t})}function n(t){return Object(i["a"])({url:"/api/articleClass/editArticleClass",method:"put",data:t})}function r(t){return Object(i["a"])({url:"/api/articleClass/delArticleClass",method:"delete",params:{id:t}})}function a(t){return Object(i["a"])({url:"/api/articleClass/delArticleClass/"+t,method:"delete"})}function l(t){return Object(i["a"])({url:"/api/articleClass/getArticleClasses/noPage",method:"get",params:t})}function c(t){return Object(i["a"])({url:"/api/articleClass/getArticleClasses",method:"get",params:t})}}}]);